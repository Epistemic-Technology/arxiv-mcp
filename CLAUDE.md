# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Model Context Protocol (MCP) server for arXiv, written in Go. It provides tools for searching academic papers on arXiv through the MCP interface.

## Architecture

The codebase follows a standard Go project structure:

- **cmd/**: Command-line applications
  - `arxiv-mcp-local-server/`: MCP server that runs via stdio transport
  - `arxiv-taxonomy-scraper/`: Utility to scrape and generate arXiv taxonomy data
- **internal/**: Internal packages
  - `server/`: Server initialization and configuration logic
  - `tools/`: MCP tool implementations
    - `search-tool.go`: Implements the `arxiv-search` tool for querying arXiv papers
    - `search_tool_test.go`: Tests for the search tool
    - `get-tool.go`: (Currently empty placeholder)
  - `resources/`: MCP resource implementations
    - `taxonomy-resource.go`: Provides arXiv category taxonomy as an MCP resource
    - `arxiv-taxonomy.json`: Embedded JSON data with arXiv categories
- **bin/**: Build artifacts directory (gitignored)

The server uses:
- `github.com/modelcontextprotocol/go-sdk` for MCP functionality
- `github.com/Epistemic-Technology/arxiv` as the arXiv API client
- `github.com/PuerkitoBio/goquery` for HTML parsing (in taxonomy scraper)

## Build System

The project includes a comprehensive Makefile with various targets.

### Common Commands

#### Build
```bash
make build                    # -o bin/arxiv-mcp-local-server Build all binaries to bin/
make arxiv-mcp-local-server  # Build just the MCP server
make arxiv-taxonomy-scraper  # Build just the taxonomy scraper
```

Build artifacts are placed in the `bin/` directory.

Build artifacts are placed in the `bin/` directory.

#### Development
```bash
make run      # Run the MCP server directly
make test     # Run all tests
make fmt      # Format code
make vet      # Check for issues
make lint     # Run linter (requires golangci-lint)
make check    # Run fmt, vet, and test
```

#### Dependencies
```bash
make tidy     # Update and clean dependencies
make deps     # Download dependencies
```

#### Testing
```bash
make test              # Run tests
make test-coverage     # Run tests with coverage report
```

#### Clean
```bash
make clean    # Remove build artifacts and coverage reports
```

## Key Implementation Details

### MCP Tools
The server exposes an `arxiv-search` tool that accepts SearchQuery parameters:
- **Field-specific filters**: Title, Author, Abstract, SubjectCategory
- **Date filtering**: SubmittedSince/SubmittedBefore (time.Time format)
- **General search**: All-fields search parameter
- **Result limit**: MaxResults (defaults to 20)

The search tool constructs arXiv API queries and returns structured search results through the MCP protocol.

### MCP Resources
The server provides a `category-taxonomy` resource:
- **URI**: `file://arxiv/taxonomy.json`
- **Content**: JSON representation of all arXiv categories with tags, labels, and descriptions
- **Source**: Generated by the arxiv-taxonomy-scraper tool from arxiv.org/category_taxonomy

### Testing
Test files are located alongside their implementation files (e.g., `search_tool_test.go`). Run tests with `make test` or `go test ./...`.

## Dependencies Management

The project uses Go modules. Key dependencies:
- MCP Go SDK for protocol implementation
- arXiv Go client library for API interactions
- goquery for HTML parsing in the taxonomy scraper

Update dependencies with `make tidy` to ensure go.mod and go.sum are in sync.